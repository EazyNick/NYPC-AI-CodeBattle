# NYPC AI CodeBattle - Yacht Dice Game AI

## 프로젝트 개요

이 프로젝트는 NYPC(NYPC AI CodeBattle)에서 사용되는 Yacht 주사위 게임을 위한 AI 에이전트입니다. 플레이어는 13라운드에 걸쳐 주사위를 굴리고, 입찰을 통해 주사위 그룹을 선택하며, 다양한 규칙에 따라 주사위를 배치하여 최고 점수를 얻는 것을 목표로 합니다.

## 게임 규칙

### 기본 규칙 (12개)
- **ONE**: 1이 적힌 주사위의 합 × 1000점
- **TWO**: 2가 적힌 주사위의 합 × 1000점
- **THREE**: 3이 적힌 주사위의 합 × 1000점
- **FOUR**: 4가 적힌 주사위의 합 × 1000점
- **FIVE**: 5가 적힌 주사위의 합 × 1000점
- **SIX**: 6이 적힌 주사위의 합 × 1000점
- **CHOICE**: 주사위에 적힌 모든 수의 합 × 1000점
- **FOUR_OF_A_KIND**: 같은 수가 4개 이상이면 모든 수의 합 × 1000점, 아니면 0점
- **FULL_HOUSE**: 3개+2개 조합이면 모든 수의 합 × 1000점, 아니면 0점
- **SMALL_STRAIGHT**: 4개 연속 수(1234, 2345, 3456)면 15000점, 아니면 0점
- **LARGE_STRAIGHT**: 5개 연속 수(12345, 23456)면 30000점, 아니면 0점
- **YACHT**: 5개 모두 같은 수면 50000점, 아니면 0점

### 보너스 시스템
- 기본 규칙(ONE~SIX) 합계가 63000점 이상이면 35000점 보너스

## AI 전략

### 1. 입찰 전략 (`calculate_bid`)

#### 상대방 배팅 패턴 분석
- 상대방이 11 이하만 배팅했다면, 최솟값 + 1만 배팅
- 상대방이 12 이상 배팅할 때까지 기존 로직 무시

#### YACHT 방해 전략
- 상대방이 66666 YACHT를 완성할 수 있다면 1001 배팅
- 상대방이 55555 YACHT를 완성할 수 있다면 2001 배팅
- 기타 YACHT 방해는 5001 배팅

#### 턴별 전략적 입찰
- **1-3턴**: 중복 개수와 합계를 고려한 전략적 입찰
- **4-8턴**: YACHT 완성 여부에 따른 전략
- **9턴 이후**: 내가 필요한 숫자와 상대방이 필요한 숫자 기반 전략

### 2. 주사위 배치 전략 (`calculate_put`)

#### 우선순위 규칙 (12개)
1. **YACHT** (50000점) - 최우선
2. **LARGE_STRAIGHT** (30000점)
3. **SMALL_STRAIGHT** (15000점)
4. **FOUR_OF_A_KIND** (높은 점수)
5. **FULL_HOUSE** (높은 점수)
6. **CHOICE** (높은 점수)
7. **SIX** (36000점) - 기본 규칙 중 최고점
8. **FIVE** (30000점) - 기본 규칙
9. **FOUR** (24000점) - 기본 규칙
10. **THREE** (18000점) - 기본 규칙
11. **TWO** (12000점) - 기본 규칙
12. **ONE** (6000점) - 기본 규칙 중 최저점

#### 전략적 규칙 사용 (`should_use_rule_strategically`)
- **3턴 특별 로직**: FULL_HOUSE가 가능하다면 SIX 사용을 지연
- **9턴 이후**: 모든 규칙을 점수 기반으로 사용
- **초반**: 고점수 규칙 우선 보존

#### 11턴 특별 로직
- 중복된 수가 가장 많은 것 중 작은 수를 우선 적용
- 규칙 외의 숫자는 사용한 기본규칙 중 가장 작은 숫자들로 채우기
- CHOICE가 남아있으면 5,6은 무조건 보존

#### 13턴 특별 로직
- 10개 주사위를 2개 규칙에 최적으로 배분하는 조합 계산
- 5중 반복문을 통한 모든 가능한 조합 탐색

### 3. 최적 주사위 조합 찾기 (`find_optimal_dice_for_rule`)

#### 기본 규칙 (ONE~SIX)
- 해당 숫자를 최대한 많이 선택 (최대 5개)
- 남은 슬롯은 전략적으로 채우기

#### 고점수 규칙
- **FOUR_OF_A_KIND**: 8라운드 전까지는 4,5,6으로만 구성된 경우만 허용
- **FULL_HOUSE**: 8라운드 전까지는 4,5,6으로만 구성된 경우만 허용
- **SMALL_STRAIGHT**: 1234, 2345, 3456 중 하나 찾기
- **LARGE_STRAIGHT**: 12345 또는 23456 찾기
- **YACHT**: 5개 모두 같은 숫자 찾기

## 주요 클래스 및 구조

### `DiceRule` (Enum)
12가지 주사위 규칙을 정의하는 열거형

### `Bid`
입찰 정보를 담는 데이터클래스
- `group`: 입찰 그룹 ('A' 또는 'B')
- `amount`: 입찰 금액

### `DicePut`
주사위 배치 정보를 담는 데이터클래스
- `rule`: 배치 규칙
- `dice`: 배치할 주사위 목록

### `GameState`
팀의 현재 상태를 관리하는 클래스
- `dice`: 현재 보유한 주사위 목록
- `rule_score`: 각 규칙별 획득 점수
- `bid_score`: 입찰로 얻거나 잃은 총 점수

### `Game`
게임 상태를 관리하는 메인 클래스
- `my_state`: 내 팀의 현재 상태
- `opp_state`: 상대 팀의 현재 상태
- `current_round`: 현재 턴 번호
- `opponent_bids`: 상대방의 각 턴별 입찰 가격

## 핵심 함수들

### 입찰 관련
- `calculate_bid()`: 주사위 그룹과 입찰 금액 결정
- `calculate_strategic_bid_amount()`: 전략적 입찰 금액 계산
- `should_block_yacht()`: YACHT 방해 필요성 확인

### 주사위 배치 관련
- `calculate_put()`: 사용할 규칙과 주사위 결정
- `find_optimal_dice_for_rule()`: 규칙별 최적 주사위 조합 찾기
- `should_use_rule_strategically()`: 전략적 규칙 사용 여부 결정

### 점수 계산 관련
- `calculate_rule_potential_score()`: 규칙별 잠재적 점수 계산
- `calculate_highest_possible_score_for_last_turn()`: 마지막 턴 최고 점수 계산

## 성능 최적화

### TLE (Time Limit Exceeded) 방지
- 13턴 특별 로직의 5중 반복문은 마지막 턴에서만 실행
- 무한 루프 방지를 위한 안전한 리스트 조작
- 빈 리스트 처리 및 예외 상황 대응

### 메모리 효율성
- 주사위 목록의 복사본 사용으로 원본 데이터 보존
- 불필요한 반복 계산 방지

### 주요 수정 사항
1. **배팅 전략 개선**: 상대방이 11 이하만 배팅할 때 최솟값 + 1만 배팅
2. **YACHT 방해 전략**: 66666은 1001, 55555는 2001 배팅
3. **FULL_HOUSE 우선순위**: 666으로 FULL_HOUSE가 가능하면 SIX 사용 지연
4. **TLE 문제 해결**: 특정 턴 특별 로직의 성능 최적화
5. **안전한 리스트 조작**: remove() 호출 전 존재 여부 확인

## 라이선스

이 프로젝트는 MIT LICENSE 파일에 명시된 조건에 따라 배포됩니다.

## 기여자

NYPC AI CodeBattle 참가자들이 개발한 AI 에이전트입니다.
